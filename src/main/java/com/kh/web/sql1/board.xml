<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace = "Board">
	<select id ="getBoardList" parameterType="hashmap" resultType="boarddto">
		SELECT * 
		FROM (SELECT rownum R, A.* 
			  FROM 
				(SELECT * FROM BOARD ORDER BY BOARDid DESC)A)
		WHERE R BETWEEN #{startRow} AND #{endRow}
	</select>
	
	<select id = "getBoardCnt" resultType="_int">
		SELECT count(*) FROM BOARD
	</select>
		
	<insert id="insertBoard" parameterType="boarddto">
		INSERT INTO BOARD values(SEQ_BOARD_ID.nextval,'USER1', '1', '1', #{title}, #{content})
   </insert>
   
	<select id="getDetail" parameterType="_int" resultType="boarddto">
	    SELECT * FROM BOARD  WHERE BOARDID = #{BOARDID}
	</select>
	
	<select id="getSeq" resultType="_int">
		SELECT SEQ_BOARD_ID.currval FROM dual
	</select>
	
	<insert id="addReply" parameterType="replydto">
		INSERT INTO datgle VALUES
		( #{boardid}, SEQ_DATGLE_NUM.nextval, 'USER1',#{content})
	</insert>
	
	<select id = "getReplys" parameterType="_int" resultType="replydto">
		SELECT * FROM datgle WHERE boardid = #{boardid}
	</select>
	
	<update id= "updateReply" parameterType="hashmap">
		UPDATE DATGLE 
		SET CONTENT = #{content}
		WHERE COMMENTNUM = #{commentnum}
	</update>
	
	<delete id = "deleteReply" parameterType="_int" >
		DELETE FROM DATGLE WHERE COMMENTNUM = #{replynum}
	</delete>
	
	<delete id="deleteBoard" parameterType="_int">
		DELETE FROM BOARD b WHERE boardid = #{boardid}
	</delete>
	
	
	<update id="updateBoard" parameterType="hashmap" >
	    UPDATE board
    	SET title = #{title}, content = #{content}
    	WHERE boardid = #{boardid}
	</update>
	
</mapper>